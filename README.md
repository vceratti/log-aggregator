# log-aggregator

## Assumptions 

[ASSUMPTIONS.md](ASSUMPTIONS.md)

## Application

Tech stack:
- PHP 8.2
- Symfony 6.2
- MySql 8.0 (@TODO: provide an elastic search implementation if there is time)
- @TODO TBD message bus
- Docker (docker compose for development)

## Requirements

Docker and Docker compose
 
## Install

The provided `composer` executable will run the application using docker-compose ahd execute composer inside
the container. To install and execute the application, run:

```bash
./composer install
```

This script runs the Docker containers with docker-compose and:
 - runs composer install 
 - run database migrations in the containers 
   - it waits for the DB to be ready, but if it times out or fail please re-run it
 
The application will be then available in `http://localhost:8080` (simple PHP native server)

## Development

All common commands are defined as composer scripts and can be executed with the provider `composer` executable

The following command will execute all expected steps before a commit is pushed:

```bash
./composer pre-commit
```

pre-commit will: 
 - update the database (migrate)
 - fix code style ([php-cs-fixer](.php-cs-fixer.dist.php)
 - syntax and type check ([phpstan](phpstan.neon.dist))
 - clean code / design check ([phpmd](phpmd.xml))
 - run tests with coverage report ([phpunit](phpunit.xml))

See 'scripts' in [composer.json](composer.json) for details

Cached resources for the container (composer cache, database persistence) as well as reports generated by the tools
mentioned above are stored in the unversioned `/var/cache` directory

